<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Async/Await and Array.forEach</title>
        
        <style>

    html body {
        font-family: Open Sans, Helvetica, Arial, sans-serif;
        background-color: white;
    }

    :root {
        --accent: blue;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="//dev-coach.me/css/main.css">


 <link rel="stylesheet" href="//dev-coach.me/custom.css"> 





<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 






<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.68.3" />
        

        

        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Async/Await and Array.forEach</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/posts/">Posts</a></li>
                            
                                <li><a href="/snippets/">Snippets</a></li>
                            
                                <li><a href="/about">About</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="https://github.com/FQ400/dev-coach-site"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/FQ400"><i class="fa fa-twitter"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>Async/Await and Array.forEach</h2>
        <h5></h5>
        
<a href="//dev-coach.me/tags/snippets"><kbd class="item-tag">snippets</kbd></a>

<a href="//dev-coach.me/tags/javascript"><kbd class="item-tag">javascript</kbd></a>

<a href="//dev-coach.me/tags/async"><kbd class="item-tag">async</kbd></a>

<a href="//dev-coach.me/tags/await"><kbd class="item-tag">await</kbd></a>


    </div>

    <div align="start" class="content"><p>Assuming we have two async calls to a database that return a promise.
<code>asyncDbCall1</code> takes longer then <code>asyncDbCall2</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">asyncDbCall1</span> <span style="color:#f92672">=</span> () =&gt; { 
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
    <span style="color:#a6e22e">setTimeout</span>(() =&gt; { <span style="color:#a6e22e">resolve</span>(<span style="color:#ae81ff">1</span>) }, <span style="color:#ae81ff">200</span>);
  })
};

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">asyncDbCall2</span> <span style="color:#f92672">=</span> () =&gt; { 
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
    <span style="color:#a6e22e">setTimeout</span>(() =&gt; { <span style="color:#a6e22e">resolve</span>(<span style="color:#ae81ff">2</span>) }, <span style="color:#ae81ff">100</span>);
  })
};
</code></pre></div><p>Calling them in sequence using <code>Array.forEach</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">[<span style="color:#a6e22e">asyncDbCall1</span>, <span style="color:#a6e22e">asyncDbCall2</span>].<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">promise</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">promise</span>();
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>);
});
<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;DONE&#34;</span>);

<span style="color:#75715e">// Resulting output
</span><span style="color:#75715e">// DONE
</span><span style="color:#75715e">// 2
</span><span style="color:#75715e">// 1
</span></code></pre></div><p>I want to finish the calls in sequence.</p>
<p>Using a <code>for</code> loop:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">promiseArray</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">asyncDbCall1</span>, <span style="color:#a6e22e">asyncDbCall2</span>];

(<span style="color:#a6e22e">async</span> <span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">promiseArray</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">promiseArray</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">call</span>();
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>);
  }
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;DONE&#34;</span>);
})();

<span style="color:#75715e">// Resulting output:
</span><span style="color:#75715e">// 1
</span><span style="color:#75715e">// 2
</span><span style="color:#75715e">// DONE
</span></code></pre></div><p>There is more &hellip; ðŸ¤“</p>
</div>
    <p class='dates'>
  <i>
    Created at
    <time dateime="2020-07-01 00:00:00 &#43;0000 UTC">
      July 1, 2020
    </time>
    
      <br />
      Updated at
      <time dateime="2020-07-01 00:00:00 &#43;0000 UTC">
        July 1, 2020
      </time>
    
  </i>
</p>


</main>

        <footer>
          
            <ul>
              
                <li><a href="/imprint">Imprint</a></li>
              
            </ul>
          
          <p class="copyright text-muted text-center">Copyright 2020 - Carsten Lamm</p>
        </footer>

        


    </body>

</html>

